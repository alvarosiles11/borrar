<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSON.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">vuelo</a> &gt; <a href="index.source.html" class="el_package">dmsnur.SharedKernel</a> &gt; <span class="el_source">JSON.java</span></div><h1>JSON.java</h1><pre class="source lang-java linenums">package dmsnur.SharedKernel;

import java.lang.reflect.Type;
import java.time.Instant;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.ZoneId;
import java.time.ZonedDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Locale;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonDeserializationContext;
import com.google.gson.JsonDeserializer;
import com.google.gson.JsonElement;
import com.google.gson.JsonParseException;
import com.google.gson.JsonPrimitive;
import com.google.gson.JsonSerializationContext;
import com.google.gson.JsonSerializer;

// import Domain.Model.Aeronaves.Aeronave;

<span class="nc" id="L24">public class JSON {</span>
<span class="nc" id="L25">    static String formatDate = &quot;yyyy-MM-dd&quot;;</span>
<span class="nc" id="L26">    static String formatDateTime = &quot;yyyy-MM-dd'T'HH:mm:ss.SSS&quot;;</span>

<span class="nc" id="L28">    static class LocalDateSerializer implements JsonSerializer&lt;LocalDate&gt; {</span>
<span class="nc" id="L29">        private static final DateTimeFormatter formatter = DateTimeFormatter.ofPattern(formatDate);</span>

        @Override
        public JsonElement serialize(LocalDate localDate, Type srcType, JsonSerializationContext context) {
<span class="nc" id="L33">            return new JsonPrimitive(formatter.format(localDate));</span>
        }
    }

<span class="nc" id="L37">    static class LocalDateTimeSerializer implements JsonSerializer&lt;LocalDateTime&gt; {</span>
<span class="nc" id="L38">        private static final DateTimeFormatter formatter = DateTimeFormatter.ofPattern(formatDateTime);</span>

        @Override
        public JsonElement serialize(LocalDateTime localDateTime, Type srcType, JsonSerializationContext context) {
<span class="nc" id="L42">            return new JsonPrimitive(formatter.format(localDateTime));</span>
        }
    }

<span class="nc" id="L46">    static class LocalDateDeserializer implements JsonDeserializer&lt;LocalDate&gt; {</span>
        @Override
        public LocalDate deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)
                throws JsonParseException {
<span class="nc" id="L50">            return LocalDate.parse(json.getAsString(),</span>
<span class="nc" id="L51">                    DateTimeFormatter.ofPattern(formatDate).withLocale(Locale.getDefault()));</span>
        }
    }

<span class="nc" id="L55">    static class LocalDateTimeDeserializer implements JsonDeserializer&lt;LocalDateTime&gt; {</span>
        @Override
        public LocalDateTime deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)
                throws JsonParseException {
<span class="nc" id="L59">            return LocalDateTime.parse(json.getAsString(),</span>
<span class="nc" id="L60">                    DateTimeFormatter.ofPattern(formatDateTime).withLocale(Locale.getDefault()));</span>
        }
    }

    public static Gson getInstance() {
<span class="nc" id="L65">        return new GsonBuilder()</span>
<span class="nc" id="L66">                .registerTypeAdapter(LocalDate.class, new LocalDateSerializer())</span>
<span class="nc" id="L67">                .registerTypeAdapter(LocalDateTime.class, new LocalDateTimeSerializer())</span>
<span class="nc" id="L68">                .registerTypeAdapter(LocalDate.class, new LocalDateDeserializer())</span>
<span class="nc" id="L69">                .registerTypeAdapter(LocalDateTime.class, new LocalDateTimeDeserializer())</span>
<span class="nc" id="L70">                .setDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS&quot;)</span>
<span class="nc" id="L71">                .create();</span>
        // return new GsonBuilder().registerTypeAdapter(LocalDateTime.class, new
        // JsonDeserializer&lt;LocalDateTime&gt;() {
        // @Override
        // public LocalDateTime deserialize(JsonElement json, Type type,
        // JsonDeserializationContext jsonDeserializationContext) throws
        // JsonParseException {
        // Instant instant =
        // Instant.ofEpochMilli(json.getAsJsonPrimitive().getAsLong());
        // return LocalDateTime.ofInstant(instant, ZoneId.systemDefault());
        // }
        // }).setDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSSZ&quot;).create();
    }

    // public static void main(String[] args) {
    // Aeronave a = new Aeronave(&quot;Hola&quot;);
    // a.eventCreado();
    // String json = getInstance().toJson(a, Aeronave.class);
    // System.out.println(json);

    // }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>